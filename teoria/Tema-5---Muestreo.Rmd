---
title: "Tema 5 - Muestreo estadístico"
author: "Juan Gabriel Gomila, Arnau Mir y Ricardo Alberich"
date: ''
output:
  ioslides_presentation:
    css: Mery_style.css
    logo: Images/matriz_mov.gif
    widescreen: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Conceptos básicos de muestreo 

```{r, include=FALSE}
options(digits = 8)
```
* En todo estudio estadístico distinguiremos entre **población**, (conjunto de sujetos con una o varias características que podemos medir y deseamos estudiar), y **muestra**, (subconjunto de una población.)

* Dos tipos de análisis estadístico:
  * **Exploratorio** o  **descriptivo**: **estadística descriptiva**.
  * **Inferencial** o **confirmatorio**: **estadística  inferencial**.
  
## Conceptos básicos de muestreo 

Pasos en un estudio inferencial:

- Establecer la característica que se desea estimar o la hipótesis que se desea contrastar.

- Determinar la información (los datos) que se necesita para hacerlo.

- Diseñar un experimento que permita recoger estos datos; este paso incluye:

    * Decidir qué tipo de muestra se va a tomar y su tamaño.
   
    * Elegir las técnicas adecuadas para realizar las inferencias deseadas a partir de la muestra que se tomará.

## Conceptos básicos de muestreo 

- Tomar una muestra y medir los datos deseados sobre los individuos que la forman.

- Aplicar las técnicas de inferencia elegidas con el *software* adecuado.

- Obtener conclusiones.

- Si las conclusiones son fiables y suficientes, redactar un informe; en caso contrario, volver a empezar.

## Tipos de muestreo: Muestreo aleatorio con y sin reposición {-}

* Un **muestreo aleatorio** consiste en seleccionar una muestra de la población de manera que todas las muestras del mismo tamaño sean **equiprobables**.


* Consideremos una urna de 100 bolas numeradas del 1 al 100:

```{r, echo=FALSE, label=urna,fig.cap="Una urna de 100 bolas",out.width = "800px"}
knitr::include_graphics("Images/basev.png",dpi=400)
```

## Tipos de muestreo: Muestreo aleatorio con y sin reposición {-}

* Queremos extraer una muestra de 15 bolas.

* Para realizar la extracción, podríamos repetir 15 veces el proceso de sacar una bola de la urna, anotar su número y devolverla a la urna. El tipo de muestra obtenida de esta manera recibe el nombre de **muestra aleatoria con reposición**, o simple (una **m.a.s.**, para abreviar).
  
```{r, echo=FALSE, label=simple,fig.cap="Una muestra aleatoria simple",out.width = "700px"}
knitr::include_graphics("Images/simplev.png",dpi=400)
```

## Tipos de muestreo: Muestreo aleatorio con reposición {-}

Las bolas violetas son las escogidas para la muestra. La bola azul se ha escogido dos veces al ser el muestreo con reposición.

Para simular un muestreo de 15 bolas con reposición en una urna de 100 en `R`, haríamos los siguiente:

<div class=r-code>
```{r}
sample(1:100, 15, replace=TRUE)
```
</div>
Fijaos que no hemos obtenido la misma muestra. Esto es debido a que no hemos fijado la **semilla de aleatoriedad**.



## Tipos de muestreo: Muestreo aleatorio con reposición {-}
<div class=example>
Veamos un ejemplo más elaborado. Consideremos la tabla de datos *iris* que contiene 150 flores de 3 especies diferentes: **setosa**, **versicolor** y **virginica**. La tabla de datos contiene 5 variables: la longitud y amplitud del pétalo, la longitud y la amplitud del sépalo y la especie de la flor:
</div>

```{r}
head(iris)
```

## Tipos de muestreo: Muestreo aleatorio con reposición {-}
<div class=example>
Si quisiéramos una muestra de 10 flores con reposición, haríamos lo siguiente:
</div>
```{r}
set.seed(4) # la función set.seed fija la semilla de aleatoriedad. 
# Sirve para que siempre dé la misma muestra.
flores.elegidas.10.con=sample(1:150,10,replace=TRUE) #elegimos las flores de la muestra.
muestra.iris.10.con = iris[flores.elegidas.10.con,] # calculamos la subtabla 
# de las flores de la muestra

```



## Tipos de muestreo: Muestreo aleatorio con reposición {-}

```{r}
muestra.iris.10.con # mostramos la muestra de las flores
```
Fijémonos que la flor número 51 se ha repetido al ser la muestra con reposición.


## Tipos de muestreo: Muestreo aleatorio sin reposición {-}
* Otra manera de extraer nuestra muestra sería repetir 15 veces el proceso de sacar una bola de la urna pero ahora sin devolverla.  En este caso se habla de una **muestra aleatoria sin reposición**:
  
```{r, echo=FALSE, label=sinrep,fig.cap="Una muestra aleatoria sin reposición",out.width = "800px"}
knitr::include_graphics("Images/sinrepv.png",dpi=400)
```

## Tipos de muestreo: Muestreo aleatorio  sin reposición {-}

Para simular un muestreo de 15 bolas sin reposición en la urna anterior de 100 en `R`, haríamos los siguiente:

```{r}
sample(1:100, 15, replace=FALSE)
```

## Tipos de muestreo: Muestreo aleatorio sin reposición {-}

Si quisiéramos una muestra de 10 flores sin reposición, haríamos lo siguiente:
```{r}
set.seed(4) # la función set.seed fija la semilla de aleatoriedad. 
# Sirve para que siempre dé la misma muestra.
flores.elegidas.10.sin=sample(1:150,10,replace=FALSE) #elegimos las flores de la muestra.
muestra.iris.10.sin = iris[flores.elegidas.10.sin,] # calculamos la subtabla 
# de las flores de la muestra

```

## Tipos de muestreo: Muestreo aleatorio con reposición {-}
```{r}
muestra.iris.10.sin # mostramos la muestra de las flores
```
Fijémonos ahora que no hay ninguna flor repetida al ser la muestra sin reposición.

## Muestreo sistemático

* Suponemos que disponemos de una lista ordenada de todos los individuos de la población. Muestreo sistemático: tomarlos a intervalos constantes escogiendo al azar el primer individuo que elegimos:

```{r, echo=FALSE, label=sist,fig.cap="Una muestra aleatoria sistemática",out.width = "800px"}
knitr::include_graphics("Images/sistv.png",dpi=400)
```

## Muestreo aleatorio estratificado {-}

* Este tipo de muestreo se utiliza cuando la población está clasificada en  **estratos** que son de interés para la propiedad estudiada.

* Se toma una muestra aleatoria de cada estrato y se unen en una muestra global. A este proceso se le llama **muestreo aleatorio estratificado**:
```{r, echo=FALSE, label=estratprevi,fig.cap="Una muestra aleatoria estratificada con dos estratos",out.width = "800px"}
knitr::include_graphics("Images/estrat.png",dpi=400)
```

## Muestreo por conglomerados {-}
* El proceso de obtener y estudiar una muestra aleatoria en algunos casos es caro o difícil, incluso aunque dispongamos de la lista completa de la población.

* Una alternativa posible sería, en vez de extraer una muestra aleatoria de todos los individuos de la población, escoger primero al azar unos subconjuntos en los que la población está dividida, a las que llamamos en este contexto **conglomerados** (*clusters*):
```{r, echo=FALSE, label=clust,fig.cap="Una muestra aleatoria por conglomerados con 2 estratos y 20 conglomerados",out.width = "600px"}
knitr::include_graphics("Images/cluster.png",dpi=400)
```

## Muestreo polietápico

* Una vez seleccionada la muestra aleatoria de conglomerados, tomar de alguna manera una muestra aleatoria de cada uno de ellos:
```{r, echo=FALSE, label=poli,fig.cap="Una muestra polietápica de 5 conglomerados y 3 bolas al azar sin reposición",out.width = "800px"}
knitr::include_graphics("Images/poli.png",dpi=400)
```

## Guía rápida

* `sample(x, n, replace=...)` genera una muestra aleatoria de tamaño `n` del vector `x`, con reposición si igualamos `replace` a `TRUE` y sin reposición si lo igualamos a `FALSE` (su valor por defecto). Si `x` es un número natural $x$, representa el vector 1,2,...,$x$.

* `set.seed` permite fijar la semilla de aleatoriedad. 

* `replicate(n,expresión)` evalúa `n` veces la `expresión`, y organiza los resultados como las columnas de una matriz (o un vector, si el resultado de cada `expresión` es unidimensional).

